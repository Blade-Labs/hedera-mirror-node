apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: mirror
  namespace: dev
spec:
  chart:
    git: https://github.com/hashgraph/hedera-mirror-node.git
    path: charts/hedera-mirror
    ref: 7ed041e569f707884bb79026b5d00b8991038e4f
  rollback:
    enable: true
    force: true
    timeout: 500
    wait: false
  timeout: 500
  wait: false
  values:
    grpc:
      image:
        tag: master-7ed041e569f707884bb79026b5d00b8991038e4f
      prometheusRules:
        GrpcNoSubscribers:
          enabled: false
    importer:
      config:
        hedera:
          mirror:
            importer:
              downloader:
                cloudProvider: GCP
              network: TESTNET
              startDate: 1970-01-01T00:00:00Z
      image:
        tag: master-7ed041e569f707884bb79026b5d00b8991038e4f
    monitor:
      config:
        hedera:
          mirror:
            monitor:
              mirrorNode:
                grpc:
                  host: dev-mirror-grpc
                rest:
                  host: dev-mirror-rest
                  port: 80
              publish:
                scenarios:
                  - name: HCS pinger
                    logResponse: true
                    properties:
                      topicId: 0.0.103736
                    record: 1
                    tps: 0.1
                    type: CONSENSUS_SUBMIT_MESSAGE
              subscribe:
                grpc:
                  - name: HCS subscribe
                    topicId: 0.0.103736
                rest:
                  - name: REST subscribe
      image:
        tag: master-7ed041e569f707884bb79026b5d00b8991038e4f
    postgresql:
      enabled: false
    rest:
      image:
        tag: master-7ed041e569f707884bb79026b5d00b8991038e4f
      prometheusRules:
        RestNoRequests:
          enabled: false
  valuesFrom:
    - chartFileRef:
        path: values-prod.yaml
    - secretKeyRef:
        name: mirror

